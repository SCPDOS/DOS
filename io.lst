     1                                      DEFAULT REL
     2                                      [map all io.map]
     3                                      BITS 64
     4                                  Section loader vstart=7C00h align=1
     5 00000000 55AA                        dw 0AA55h           ;Initial signature
     6                                  
     7 00000002 B800060000                  mov eax, 0600h  ;CLS
     8 00000007 31C9                        xor ecx, ecx
     9 00000009 BA4F180000                  mov edx, 184Fh
    10 0000000E B707                        mov bh, 07h
    11 00000010 CD30                        int 30h
    12 00000012 B800020000                  mov eax, 0200h  ;Move cursor up top
    13 00000017 31D2                        xor edx, edx
    14 00000019 30FF                        xor bh, bh
    15 0000001B CD30                        int 30h
    16 0000001D 48BD-                       mov rbp, startmsg
    16 0000001F [CE00000000000000] 
    17 00000027 B804130000                  mov eax, 1304h
    18 0000002C CD30                        int 30h
    19 0000002E B9000100C0                  mov ecx, 0C0000100h
    20 00000033 0F32                        rdmsr
    21 00000035 4889C5                      mov rbp, rax    ;Save ptr in rbp
    22 00000038 6687DB                      xchg bx, bx
    23                                  lp:
    24 0000003B 30D2                        xor dl, dl
    25 0000003D 4889EB                      mov rbx, rbp
    26 00000040 B8FF820000                  mov eax, 82FFh  ;LBA read
    27 00000045 B900010000                  mov ecx, 100h
    28 0000004A CD33                        int 33h
    29 0000004C 727B                        jc exit
    30                                  
    31 0000004E B404                        mov ah, 04h
    32 00000050 CD30                        int 30h
    33 00000052 48BD-                       mov rbp, msg1
    33 00000054 [0601000000000000] 
    34 0000005C B804130000                  mov eax, 1304h
    35 00000061 CD30                        int 30h
    36                                  
    37 00000063 30D2                        xor dl, dl
    38 00000065 4889EB                      mov rbx, rbp
    39 00000068 B8FF830000                  mov eax, 83FFh
    40 0000006D B900010000                  mov ecx, 100h
    41 00000072 CD33                        int 33h
    42 00000074 7253                        jc exit   
    43                                  
    44 00000076 B404                        mov ah, 04h
    45 00000078 CD30                        int 30h
    46 0000007A 48BD-                       mov rbp, msg2
    46 0000007C [1701000000000000] 
    47 00000084 B804130000                  mov eax, 1304h
    48 00000089 CD30                        int 30h
    49                                  
    50 0000008B 30D2                        xor dl, dl
    51 0000008D 4889EB                      mov rbx, rbp
    52 00000090 B8FF840000                  mov eax, 84FFh
    53 00000095 B900010000                  mov ecx, 100h
    54 0000009A CD33                        int 33h
    55 0000009C 722B                        jc exit
    56                                  
    57 0000009E B404                        mov ah, 04h
    58 000000A0 CD30                        int 30h
    59 000000A2 48BD-                       mov rbp, msg3
    59 000000A4 [2B01000000000000] 
    60 000000AC B804130000                  mov eax, 1304h
    61 000000B1 CD30                        int 30h
    62                                  lp1:
    63 000000B3 48BD-                       mov rbp, strng
    63 000000B5 [E400000000000000] 
    64 000000BD B804130000                  mov eax, 1304h
    65 000000C2 CD30                        int 30h
    66 000000C4 E9FBFFFFFF                  jmp $
    67                                  exit:
    68 000000C9 6687DB                      xchg bx, bx
    69 000000CC EBE5                        jmp short lp1
    70 000000CE 5374617274696E6720-     startmsg db "Starting SCP/DOS...",0Ah,0Dh,0
    70 000000D7 5343502F444F532E2E-
    70 000000E0 2E0A0D00           
    71 000000E4 0A0D496E76616C6964-     strng db 0Ah, 0Dh,"Invalid IO.SYS. System Halting.",0
    71 000000ED 20494F2E5359532E20-
    71 000000F6 53797374656D204861-
    71 000000FF 6C74696E672E00     
    72 00000106 6820536563746F7273-     msg1  db "h Sectors Read",0Ah,0Dh,0
    72 0000010F 20526561640A0D00   
    73 00000117 6820536563746F7273-     msg2  db "h Sectors Written", 0Ah, 0Dh, 0
    73 00000120 205772697474656E0A-
    73 00000129 0D00               
    74 0000012B 6820536563746F7273-     msg3  db "h Sectors Verified", 0
    74 00000134 205665726966696564-
    74 0000013D 00                 
